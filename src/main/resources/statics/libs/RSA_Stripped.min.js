var RSAAPP={};RSAAPP.NoPadding="NoPadding";RSAAPP.PKCS1Padding="PKCS1Padding";RSAAPP.RawEncoding="RawEncoding";RSAAPP.NumericEncoding="NumericEncoding";function RSAKeyPair(b,d,a,c){this.e=biFromHex(b);this.d=biFromHex(d);this.m=biFromHex(a);if(typeof(c)!="number"){this.chunkSize=2*biHighIndex(this.m)}else{this.chunkSize=c/8}this.radix=16;this.barrett=new BarrettMu(this.m)}function encryptedString(q,v,c,b){var p=new Array();var d=v.length;var h,g,f;var l;var o;var m;var n;var u="";var e;var t;var r;if(typeof(c)=="string"){if(c==RSAAPP.NoPadding){l=1}else{if(c==RSAAPP.PKCS1Padding){l=2}else{l=0}}}else{l=0}if(typeof(b)=="string"&&b==RSAAPP.RawEncoding){o=1}else{o=0}if(l==1){if(d>q.chunkSize){d=q.chunkSize}}else{if(l==2){if(d>(q.chunkSize-11)){d=q.chunkSize-11}}}h=0;if(l==2){g=d-1}else{g=q.chunkSize-1}while(h<d){if(l){p[g]=v.charCodeAt(h)}else{p[h]=v.charCodeAt(h)}h++;g--}if(l==1){h=0}g=q.chunkSize-(d%q.chunkSize);while(g>0){if(l==2){m=Math.floor(Math.random()*256);while(!m){m=Math.floor(Math.random()*256)}p[h]=m}else{p[h]=0}h++;g--}if(l==2){p[d]=0;p[q.chunkSize-2]=2;p[q.chunkSize-1]=0}n=p.length;for(h=0;h<n;h+=q.chunkSize){e=new BigInt();g=0;for(f=h;f<(h+q.chunkSize);++g){e.digits[g]=p[f++];e.digits[g]+=p[f++]<<8}t=q.barrett.powMod(e,q.e);if(o==1){r=biToBytes(t)}else{r=(q.radix==16)?biToHex(t):biToString(t,q.radix)}u+=r}return u}function decryptedString(h,l){var k=l.split(" ");var d;var g,f;var e;var a="";for(g=0;g<k.length;++g){if(h.radix==16){e=biFromHex(k[g])}else{e=biFromString(k[g],h.radix)}d=h.barrett.powMod(e,h.d);for(f=0;f<=biHighIndex(d);++f){a+=String.fromCharCode(d.digits[f]&255,d.digits[f]>>8)}}if(a.charCodeAt(a.length-1)==0){a=a.substring(0,a.length-1)}return(a)};